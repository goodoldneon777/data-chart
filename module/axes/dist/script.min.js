var m_axes={input:{y_axis:{category:null,param:[],min:null,max:null},x_axis:{category:null,param:[],min:null,max:null,round_factor:null},filter_main:{date_min:null,date_max:null,year_min:null,tap_grade:null}}};m_axes.start=function(){"use strict";var a=moment().subtract(30,"days").calendar();a=moment(a,"M/D/YYYY").format("M/D/YYYY"),$(".m-axes .filter-main .date-min").val(a)},m_axes.watch=function(){"use strict";$(".m-axes").on("change",".watch",function(){var a=$(this),b=$(this).closest(".select-wrap").find(" > .elem-expand");m_axes.createCategoryFilter(a),m_axes.refreshElemExpand(a,b)})},m_axes.validate=function(){"use strict";var a="",b=$(".m-axes .y-axis .min").val(),c=$(".m-axes .y-axis .max").val(),d=$(".m-axes .x-axis .x-category").val(),e=$(".m-axes .x-axis .min").val(),f=$(".m-axes .x-axis .max").val(),g=$(".m-axes .x-axis .round-factor").val().toLowerCase(),h=$(".m-axes .x-axis .round-count").val(),i=$(".m-axes .filter-main .date-min").val(),j=$(".m-axes .filter-main .date-max").val();return b.length>0&&!$.isNumeric(b)&&(a+="<li>Y-axis 'Min' is invalid. Must be a number.</li> \n"),c.length>0&&!$.isNumeric(c)&&(a+="<li>Y-axis 'Max' is invalid. Must be a number.</li> \n"),!$(".m-axes .x-axis .filter-wrap").hasClass("hidden")&&e.length>0&&!$.isNumeric(e)&&(a+="<li>X-axis 'Min' is invalid. Must be a number.</li> \n"),!$(".m-axes .x-axis .filter-wrap").hasClass("hidden")&&f.length>0&&!$.isNumeric(f)&&(a+="<li>X-axis 'Max' is invalid. Must be a number.</li> \n"),"tap_dt"===d?g.length>0&&-1===$.inArray(g,["day","week","month","year"])&&(a+="<li>'Round Factor' is invalid. Must be a 'day', 'week', 'month', or 'year'.</li> \n"):g.length>0&&!$.isNumeric(g)&&(a+="<li>'Round Factor' is invalid. Must be a number.</li> \n"),h&&($.isNumeric(h)||(a+="<li>'Round Count' is invalid. Must be a number.</li> \n")),0!==i.length||isValidDate(i)||(a+="<li>'Date Min' is blank. You must set a minimum date.</li> \n"),i.length>0&&!isValidDate(i)&&(a+="<li>'Date Min' is invalid. Must be a date.</li> \n"),j.length>0&&!isValidDate(j)&&(a+="<li>'Date Max' is invalid. Must be a date.</li> \n"),isValidDate(i)&&isValidDate(j)&&(i=moment(i,"M/D/YYYY"),j=moment(j,"M/D/YYYY"),i>j&&(a+="<li>'Date Min' must be before 'Date Max'.</li> \n")),a},m_axes.parse=function(){"use strict";var a=$(".m-axes .y-axis"),b=$(".m-axes .x-axis"),c=$(".m-axes .filter-main");m_axes.input.y_axis={category:a.find(".y-category").val(),param:[],min:ifBlank(a.find(".min").val(),null),max:ifBlank(a.find(".max").val(),null)},a.find("select option:selected").each(function(a){m_axes.input.y_axis.param.push({value:$(this).val(),text:$(this).text()})}),m_axes.input.x_axis={category:b.find(".x-category").val(),param:[],min:null,max:null,round_factor:ifBlank(b.find(".round-factor").val().toLowerCase(),null),round_count:ifBlank(b.find(".round-count").val(),null)},b.find("select option:selected").each(function(a){m_axes.input.x_axis.param.push({value:$(this).val(),text:$(this).text()})}),$(".m-axes .x-axis .filter-wrap").hasClass("hidden")||(m_axes.input.x_axis.min=ifBlank(b.find(".min").val(),null),m_axes.input.x_axis.max=ifBlank(b.find(".max").val(),null));var d=ifBlank(c.find(".date-min").val(),null);d=moment(d,"M/D/YYYY").format("YYYY-MM-DD");var e=ifBlank(c.find(".date-max").val(),null);e&&(e=moment(e,"M/D/YYYY").format("YYYY-MM-DD"));var f=moment(d,"YYYY-MM-DD").format("YY");return m_axes.input.filter_main={date_min:d,date_max:e,year_min:f,tap_grade:ifBlank(c.find(".tap-grade").val(),null)},!0},m_axes.refreshElemExpand=function(a,b){"use strict";var c="",d=a.val();$.ajax({type:"POST",url:gVar.root+"/module/form_elem/dist/ajax_receiver_elem_expand.php",data:{name_id:JSON.stringify(d)},dataType:"json",success:function(a){b.html(a.html)},error:function(a,b,d){c="Status: "+b+"\nError: "+d,console.log(c)}})},m_axes.createCategoryFilter=function(a){"use strict";var b=a.closest(".category-wrap"),c=m_axes.createParamArray(b);$.ajax({type:"POST",url:gVar.root+"/module/category_filter/dist/ajax_receiver.php",data:{param_array:JSON.stringify(c)},dataType:"json",success:function(a){b.find(".filter-wrap").html(a)},error:function(a,b,c){var d="Status: "+b+"\nError: "+c;console.log(d)}})},m_axes.createParamArray=function(a){"use strict";var b=[];return a.find("select option:selected").each(function(a){b.push({value:$(this).val(),text:$(this).text()})}),b},$(document).ready(function(){m_axes.start(),m_axes.watch(),$(".m-axes .y-category").trigger("change"),$(".m-axes .x-category").trigger("change")});